<!doctype html>
<meta charset="utf-8">
<title>Treasure hunter</title>
<style> * {margin: 0; padding: 0;} </style>
<body>
<script src="libs/ga.js"></script>
<script src="libs/plugins.js"></script>
<script>
var windowHalfWidth = 512;
var g = ga(
  windowHalfWidth*2, 512, setup,
  [
    "assets/images/SantaGame.json"
    //"assets/sounds/battleThemeA.mp3"
  ],
  load
);

var player, traject, bullets;

g.start();
g.scaleToWindow();

window.addEventListener("resize", function(event){
  g.scaleToWindow();
});

function setup() {
    g.progressBar.remove();

    g.canvas.style.border = "1px black dashed";
    g.backgroundColor = "white";
    g.state = play;

    bullets = [];

    gameScene = g.group();

    player = g.rectangle(144, 48, "blue");
    player.x = windowHalfWidth - player.halfWidth;
    player.y = 8;
    gameScene.addChild(player);

    traject = g.rectangle(5, 100, "red");
    traject.visible = false;
    gameScene.addChild(traject);

    g.pointer.press = function() {
        traject.x = player.x + player.halfWidth;
        traject.y = player.y + 2*player.halfHeight;
        traject.visible = true;
    }

    g.pointer.release = function() {
        traject.visible = false;
        g.shoot(
            player,      //The shooting sprite
            1.57,        //The angle, in radians, at which to shoot (4.71 is up)
            16,          //The bullet's offset from the center of the sprite
            7,           //The bullet's speed (pixels per frame)
            bullets,
            function() {
                return g.sprite("treasure.png");
            }
        );
    }
}

function play() {
    g.move(bullets);
}

function end() {
}

function load(){
    g.progressBar.create(g.canvas, g.assets);
    g.progressBar.update();
}
</script>
</body>